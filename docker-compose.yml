version: '3'
services:
  node-service:
    environment:
      - KEYNAME
    container_name: node-container
    build:
      context: .
      target: node
    stdin_open: true # applies only to attaching
    tty: true        # applies only to attaching
    command: []
    ports:
    - "8080:8080"
    - "3000:3000"
    - "80:80"
    image: node-dev-env-img
    volumes:
    - ./src:/home/node/src
    - ./gitfile:/home/node/.gitconfig
    - ./auth.sh:/home/node/auth.sh
    - ./secrets:/home/node/.ssh
  git-service:
    environment:
      - KEYNAME
    container_name: git-container
    stdin_open: true # applies only to attaching
    tty: true        # applies only to attaching
    build:
      context: .
      target: node-git
    command: []
    image: node-dev-env-img
    volumes:
    - .:/home/node